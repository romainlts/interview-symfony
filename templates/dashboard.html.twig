{% extends 'base.html.twig' %}

{% block title %}Dashboard{% endblock %}

{% block js %}
    {{ parent() }}
    <!-- Page  JS files -->
    <script src="{{ asset('assets/js/dashboard.js') }}"></script>
    <!-- /theme JS files -->
{% endblock %}

{% block body_class %}navbar-top bg-secondary{% endblock %}

{% block body %}
	<!-- Main navbar -->
	<div class="navbar navbar-expand-md navbar-dark border-transparent shadow-0 fixed-top">
		<div class="collapse navbar-collapse" id="navbar-mobile">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a href="javascript:;" class="navbar-nav-link font-weight-bold">Interview Symfony - Basic web skills test</a>
				</li>
			</ul>

			<ul class="navbar-nav">
				<li class="nav-item">
					<a href="{{ path('app_dashboard') }}" class="navbar-nav-link active">Dashboard</a>
				</li>
			</ul>

			<ul class="navbar-nav ml-auto">
				<li class="nav-item dropdown dropdown-user">
					<a href="#" class="navbar-nav-link d-flex align-items-center dropdown-toggle" data-toggle="dropdown">
						<span>{{ app.user.getUserIdentifier() }}</span>
					</a>
					<div class="dropdown-menu dropdown-menu-right">
						<a href="{{ path('app_logout') }}" class="dropdown-item">
							<i class="icon-switch2"></i>
							Logout</a>
					</div>
				</li>
			</ul>
		</div>
	</div>
	<!-- /main navbar -->

	<!-- Page content -->
	<div class="page-content">
		<!-- Main content -->
		<div class="content-wrapper">
			<!-- Content area -->
			<div class="content">

				<!-- Beneficiaries not persisted -->
				<div class="card">
					<div class="card-header header-elements-inline bg-dark">
						<h5 class="card-title">
							Reconnect Beneficiaries
							<span class="font-size-base ml-2">- Not persisted</span>
						</h5>
						<div class="header-elements">
							<form action="javascript:;">
								<div class="form-group-feedback form-group-feedback-right">
									<input type="search" id="search-non-persisted" class="form-control text-white wmin-200" placeholder="Search...">
									<div class="form-control-feedback">
										<i class="icon-search4 font-size-base text-muted"></i>
									</div>
								</div>
							</form>
						</div>
					</div>
					<div class="card-body">
						<div class="row">
							{% for beneficiary in nonPersistedBeneficiaries %}
								<div class="col-xl-2 col-sm-6 beneficiary-non-persisted" data-name="{{ beneficiary.firstName|lower }}">
									<div class="card">
										<div class="card-body text-center">
											<div class="card-img-actions d-inline-block mb-3">
												<img class="img-fluid rounded-circle" src="{{ beneficiary.avatarUrl }}" width="170" height="170" alt="avatar">
											</div>
											<h6 class="font-weight-semibold mb-0">{{ beneficiary.firstName|capitalize }}</h6>
										</div>
									</div>
								</div>
							{% endfor %}
						</div>
					</div>
				</div>
				<!-- /Beneficiaries not persisted -->

				<!-- Beneficiaries in database -->
				<div class="card">
					<div class="card-header header-elements-inline bg-dark">
						<h5 class="card-title">
							Reconnect Beneficiaries
							<span class="font-size-base ml-2">- In database</span>
						</h5>
						<div class="header-elements">
							<form action="javascript:;">
								<div class="form-group-feedback form-group-feedback-right">
									<input type="search" id="search-persisted" class="form-control text-white wmin-200" placeholder="Search...">
									<div class="form-control-feedback">
										<i class="icon-search4 font-size-base text-muted"></i>
									</div>
								</div>
							</form>
						</div>
					</div>

					<div class="card-body">
						<div id="beneficiaries-container" class="row">
							<!-- Beneficiaries will be loaded here via JS -->
							<div class="col-12 text-center">
								<i class="icon-spinner2 spinner"></i>
                            </div>
						</div>
					</div>

					<div class="card-footer bg-white d-flex justify-content-between align-items-center">
						<div></div>
						<button type="button" class="btn btn-outline bg-indigo-400 text-indigo-400 border-indigo-400 legitRipple" 
						data-toggle="modal" data-target="#modal_form_vertical">
							Add New Beneficiary <i class="icon-plus3 ml-2"></i>
						</button>
					</div>
				</div>
				<!-- /Beneficiaries in database -->

				<!-- Modal for adding new beneficiary -->
				<div id="modal_form_vertical" class="modal fade" tabindex="-1">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title">Add New Beneficiary</h5>
								<button type="button" class="close" data-dismiss="modal">&times;</button>
							</div>
							{{ form_start(beneficiaryForm, { attr: { novalidate: 'novalidate' } }) }}
								<div class="modal-body">
									<div class="form-group row">
										<label class="col-lg-3 col-form-label">{{ form_label(beneficiaryForm.name) }}:</label>
										<div class="col-lg-9">
											{{ form_widget(beneficiaryForm.name, {'attr': {'class': 'form-control'}}) }}
										</div>
									</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
									{{ form_widget(beneficiaryForm.submit, {'attr': {'class': 'btn bg-primary'}}) }}
									<button type="button" class="btn btn-success" id="beneficiary-create-btn">Submit via API</button>
								</div>
							{{ form_end(beneficiaryForm) }}
						</div>
					</div>
				</div>
				<!-- /modal for adding new beneficiary -->

				<!-- Modal for beneficiary deletion -->
				<div id="modal_beneficiary_deletion" class="modal fade" tabindex="-1">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title">Beneficiary deletion</h5>
								<button type="button" class="close" data-dismiss="modal">&times;</button>
							</div>
 						    {{ form_start(beneficiaryDeleteForm, { attr: { id: 'beneficiary-delete-form', novalidate: 'novalidate' } }) }}
							    {{ form_widget(beneficiaryDeleteForm.id, { id: 'beneficiary-delete-id', type: 'hidden' }) }}
							    <div class="modal-body">
								    <div class="bootbox-body">
										Are you sure you want to delete 
										<span id="beneficiary-delete-name" class="font-weight-bold">this beneficiary</span>
										? This action cannot be undone.
									</div>
							    </div>
								<div class="modal-footer">
									<button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
									<button type="submit" class="btn bg-danger">Confirm</button>
								</div>
							{{ form_end(beneficiaryDeleteForm) }}
						</div>
					</div>
				</div>
				<!-- /modal for beneficiary deletion -->

				<!-- Modal for beneficiary modification -->
				<div id="modal_beneficiary_modification" class="modal fade" tabindex="-1">
					<div class="modal-dialog">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title">Beneficiary modification</h5>
								<button type="button" class="close" data-dismiss="modal">&times;</button>
							</div>
 						    {{ form_start(beneficiaryUpdateForm, { attr: { id: 'beneficiary-update-form', novalidate: 'novalidate' } }) }}
							    {{ form_widget(beneficiaryUpdateForm.id, { id: 'beneficiary-update-id', type: 'hidden' }) }}
							    <div class="modal-body">
									<div class="form-group row">
										<label class="col-lg-3 col-form-label">{{ form_label(beneficiaryUpdateForm.name) }}:</label>
										<div class="col-lg-9">
											{{ form_widget(beneficiaryUpdateForm.name, { id: 'beneficiary-update-name', 'attr': {'class': 'form-control'}}) }}
										</div>
									</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
									<button type="submit" class="btn bg-primary">Confirm</button>
								</div>
							{{ form_end(beneficiaryUpdateForm) }}
						</div>
					</div>
				</div>
				<!-- /Modal for beneficiary modification -->

			</div>
			<!-- /content area -->
		</div>
		<!-- /main content -->
	</div>
	<!-- /page content -->
{% endblock %}
